<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Grade de Horários Movom</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root{
  --lilas:#6a5acd;
  --ciano:#4fc3f7;
  --bg:#f7f5ff;
}
body{
  font-family:Poppins,Arial;
  background:var(--bg);
  padding:20px;
}
h2,h3{text-align:center;color:var(--lilas);}
.tabs{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-bottom:20px;
}
.tab{
  padding:8px 16px;
  border-radius:20px;
  cursor:pointer;
  background:#ddd;
}
.tab.active{
  background:var(--lilas);
  color:#fff;
}
.aba{display:none;}
.aba.active{display:block;}
</style>
</head>

<body>

<h2>Grade de Horários Movom</h2>

<!-- ABAS -->
<div class="tabs">
  <div class="tab active" data-aba="geral">Agenda Geral</div>
  <div class="tab" data-aba="ale">Agenda Ale</div>
</div>

<!-- ABA GERAL -->
<div id="aba-geral" class="aba active">
  <div id="container-geral"></div>
</div>

<!-- ABA ALE -->
<div id="aba-ale" class="aba">
  <div id="container-ale"></div>
</div>

<script>
// ================= FIREBASE =================
const firebaseConfig = {
  apiKey: "AIzaSyASKbZ204Yls9IU3HenHTsHwqgbpotUga0",
  authDomain: "horariomovom.firebaseapp.com",
  databaseURL: "https://horariomovom-default-rtdb.firebaseio.com",
  projectId: "horariomovom",
  storageBucket: "horariomovom.firebasestorage.app",
  messagingSenderId: "827903999846",
  appId: "1:827903999846:web:e2495e75cc0f8b4ad852a7"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ================= ABAS =================
document.querySelectorAll(".tab").forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.querySelectorAll(".aba").forEach(a=>a.classList.remove("active"));
    tab.classList.add("active");
    document.getElementById("aba-"+tab.dataset.aba).classList.add("active");
  }
});

// ================= ESTRUTURA BASE =================
function horas(i,f){
  const h=[];
  for(let x=i;x<f;x++) h.push(`${String(x).padStart(2,"0")}:00`);
  return h;
}

const semana = [
  {dia:"Segunda-feira",horas:horas(7,19)},
  {dia:"Terça-feira",horas:horas(7,19)},
  {dia:"Quarta-feira",horas:horas(7,19)},
  {dia:"Quinta-feira",horas:horas(7,19)},
  {dia:"Sexta-feira",horas:horas(7,18)},
  {dia:"Sábado",horas:horas(7,11)}
];

// ================= FUNÇÃO GENÉRICA =================
function montarAgenda(containerId, path, nomeInstrutor){
  const container=document.getElementById(containerId);

  function salvar(){
    const dados=[];
    container.querySelectorAll("table").forEach(t=>{
      const dia=t.dataset.dia;
      const linhas=[];
      t.querySelectorAll("tbody tr").forEach(tr=>{
        linhas.push({
          hora: tr.querySelector(".hora").innerText,
          alunos:[...tr.querySelectorAll("input")].map(i=>i.value)
        });
      });
      dados.push({dia,linhas});
    });
    db.ref(path).set(dados);
  }

  function aluno(nome){
    const d=document.createElement("div");
    d.innerHTML=`<input value="${nome||""}"> <button>X</button>`;
    d.querySelector("input").oninput=salvar;
    d.querySelector("button").onclick=()=>{d.remove();salvar();};
    return d;
  }

  function linha(hora,s){
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td class="hora">${hora}</td>
      <td><strong>${nomeInstrutor}</strong><div></div><button>+ Aluno</button></td>
    `;
    const box=tr.querySelector("div");
    (s?.alunos||[]).forEach(a=>box.appendChild(aluno(a)));
    tr.querySelector("button").onclick=()=>{
      box.appendChild(aluno(""));
      salvar();
    };
    return tr;
  }

  db.ref(path).on("value",snap=>{
    const dados=snap.val();
    container.innerHTML="";
    semana.forEach(d=>{
      const h3=document.createElement("h3");
      h3.innerText=d.dia;
      const table=document.createElement("table");

